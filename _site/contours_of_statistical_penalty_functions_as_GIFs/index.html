<!DOCTYPE html>
<html>
  <head>
    <title>Contours of statistical penalty functions as GIF images – Alexej Gossmann</title>

        <meta charset="utf-8" />
    <meta content='text/html; charset=utf-8' http-equiv='Content-Type'>
    <meta http-equiv='X-UA-Compatible' content='IE=edge'>
    <meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1.0'>

    
    <meta name="description" content="Many statistical modeling problems reduce to a minimization problem of the general form:

" />
    <meta property="og:description" content="Many statistical modeling problems reduce to a minimization problem of the general form:

" />
    
    <meta name="author" content="Alexej Gossmann" />

    
    <meta property="og:title" content="Contours of statistical penalty functions as GIF images" />
    <meta property="twitter:title" content="Contours of statistical penalty functions as GIF images" />
    

    <!--[if lt IE 9]>
      <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <link rel="stylesheet" type="text/css" href="/style.css" />
    <link rel="alternate" type="application/rss+xml" title="Alexej Gossmann - PhD student with focus on statistics, machine learning, and programming, among other things" href="/feed.xml" />

    <!-- Created with Jekyll Now - http://github.com/barryclark/jekyll-now -->

    <!-- MathJax integration and configuration-->
    <!-- Use standard LaTeX delimiters and turn on equation numbering -->
    <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        inlineMath: [ ["$","$"] ],
        displayMath: [ ["$$","$$"] ],
        processEscapes: true
      },
      TeX: {
        equationNumbers: { autoNumber: "AMS" },
        Macros: {
          subscript: ['_{#1}', 1],
          superscript: ['^{#1}', 1]
        }
      }
    });
    </script>
    <script type="text/javascript" async
      src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS_HTML-full">
    </script>
 </head>

  <body>
    <div class="wrapper-masthead">
      <header class="masthead clearfix">
        <a href="/" class="site-avatar"><img src="/images/avatar.png"></a>

        <div class="site-info">
          <h1 class="site-name"><a href="/">Alexej Gossmann</a></h1>
          <p class="site-description">PhD student with focus on statistics, machine learning, and programming, among other things</p>
        </div>

        <nav>
          <a href="/">/blog/</a>
          <a href="/publications">/publications/</a>
          <a href="/code">/code/</a>
          <a href="/about">/about/</a>
        </nav>
      </header>
    </div>

    <div id="main" role="main" class="container">
      <article class="post">
  <h1>Contours of statistical penalty functions as GIF images</h1>

  <div class="entry">
    <p>Many statistical modeling problems reduce to a minimization problem of the general form:</p>

<script type="math/tex; mode=display">\begin{equation}
\mathrm{minimize}\subscript{\boldsymbol{\beta}\in\mathbb{R}^m}\quad f(\mathbf{X}, \boldsymbol{\beta}) + \lambda g(\boldsymbol{\beta}),
\end{equation}</script>

<p>or</p>

<script type="math/tex; mode=display">% <![CDATA[
\begin{eqnarray}
&\mathrm{minimize}\subscript{\boldsymbol{\beta}\in\mathbb{R}^m}\quad f(\mathbf{X}, \boldsymbol{\beta}),\\
&\mathrm{subject\,to}\quad g(\boldsymbol{\beta}) \leq t,
\end{eqnarray} %]]></script>

<p>where $f$ is some type of <em>loss function</em>, $\mathbf{X}$ denotes the data, and $g$ is a <em>penalty</em>, also referred to by other names, such as “regularization term” (problems (1) and (2-3) are often equivalent by the way). Of course both, $f$ and $g$, may depend on further parameters.</p>

<p>There are multiple reasons why it can be helpful to check out the contours of such penalty functions $g$:</p>

<ol>
  <li>When $\boldsymbol{\beta}$ is two-dimensional, the solution of problem (2-3) can be found by simply taking a look at the contours of $f$ and $g$.</li>
  <li>That builds intuition for what happens in more than two dimensions, and in other more general cases.</li>
  <li>From a Bayesian point of view, problem (1) can often be interpreted as an <a href="https://en.wikipedia.org/wiki/Maximum_a_posteriori_estimation">MAP</a> estimator, in which case the contours of $g$ are also contours of the prior distribution of $\boldsymbol{\beta}$.</li>
</ol>

<p>Therefore, it is meaningful to visualize the set of points that $g$ maps onto the unit ball in $\mathbb{R}^2$, i.e., the set</p>

<script type="math/tex; mode=display">B\subscript{g} := \{ \mathbf{x}\in\mathbb{R}^2 : g(\mathbf{x}) \leq 1 \}.</script>

<p>Below you see GIF images of such sets $B\subscript{g}$ for various penalty functions $g$ in 2D, capturing the effect of varying certain parameters in $g$. The covered penalty functions include the family of $p$-norms, the elastic net penalty, the fused penalty, the sorted $\ell_1$ norm, and several others.</p>

<p><img class="emoji" title=":white_check_mark:" alt=":white_check_mark:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/2705.png" height="20" width="20"> R code to reproduce the GIFs is provided.</p>

<h2 id="p-norms-in-2d">p-norms in 2D</h2>

<p>First we consider the $p$-norm,</p>

<script type="math/tex; mode=display">g\subscript{p}(\boldsymbol{\beta}) = \lVert\boldsymbol{\beta}\rVert\subscript{p}^{p} = \lvert\beta\subscript{1}\rvert^p + \lvert\beta\subscript{2}\rvert^p,</script>

<p>with a varying parameter $p \in (0, \infty]$ (which actually isn’t a proper <a href="https://en.wikipedia.org/wiki/Norm_(mathematics)">norm</a> for $p &lt; 1$). Many statistical methods, such as <em>LASSO</em> (Tibshirani 1996) and <em>Ridge Regression</em> (Hoerl and Kennard 1970), employ $p$-norm penalties. To find all $\boldsymbol{\beta}$ on the boundary of the 2D unit $p$-norm ball, given $\beta_1$ (the first entry of $\boldsymbol{\beta}$), $\beta_2$ is easily obtained as</p>

<script type="math/tex; mode=display">\beta_2 = \pm (1-|\beta_1|^p)^{1/p}, \quad \forall\beta_1\in[-1, 1].</script>

<p><img src="/images/penalty_function_contours/p-norm_balls.gif" alt="Loading..." title="p-norm balls"></p>

<!-- When the loss function $f$ is the mean squared error, its contours are ellipses centered at the least squares solution. The solution to the constrained minimization problem in this case lies at the point, at which the contours of $f$ and the $t$-"norm"-ball of $g$ meet for the first time, as shown in the following GIF image.

TODO: GIF

We observe that for $p \leq 1$ one of the $\beta\subscript{i}$s tends to be equal to zero, i.e., the solution is *sparse*. -->

<h2 id="elastic-net-penalty-in-2d">Elastic net penalty in 2D</h2>

<p>The elastic net penalty can be written in the form</p>

<script type="math/tex; mode=display">g\subscript{\alpha}(\boldsymbol{\beta}) = \alpha \lVert \boldsymbol{\beta} \rVert\subscript{1} + (1 - \alpha) \lVert \boldsymbol{\beta} \rVert\subscript{2}^{2},</script>

<p>for $\alpha\in(0,1)$. It is quite popular with a variety of regression-based methods (such as the <em>Elastic Net</em>, of course). We obtain the corresponding 2D unit “ball”, by calculating $\beta\subscript{2}$ from a given $\beta\subscript{1}\in[-1,1]$ as</p>

<script type="math/tex; mode=display">\beta\subscript{2} = \pm \frac{-\alpha + \sqrt{\alpha^2 - 4 (1 - \alpha) ((1 - \alpha) \beta\subscript{1}^2 + \alpha \beta\subscript{1} - 1)}}{2 - 2 \alpha}.</script>

<p><img src="/images/penalty_function_contours/elastic_net_balls.gif" alt="Loading..." title="elastic net balls"></p>

<h2 id="fused-penalty-in-2d">Fused penalty in 2D</h2>

<p>The <em>fused</em> penalty can be written in the form</p>

<script type="math/tex; mode=display">g\subscript{\alpha}(\boldsymbol{\beta}) = \alpha \lVert \boldsymbol{\beta} \rVert\subscript{1} + (1 - \alpha) \sum\subscript{i = 2}^m \lvert \beta\subscript{i} - \beta\subscript{i-1} \rvert.</script>

<p>It encourages neighboring coefficients $\beta\subscript{i}$ to have similar values, and is utilized by the <em>fused LASSO</em> (Tibshirani et. al. 2005) and similar methods.</p>

<p><img src="/images/penalty_function_contours/fused_penalty_balls.gif" alt="Loading..." title="fused penalty"></p>

<p>(Here I have simply evaluated the fused penalty function on a grid of points in $[-2,2]^2$, because figuring out equations in parametric form for the above polygons was too painful for my taste… <img class="emoji" title=":stuck_out_tongue:" alt=":stuck_out_tongue:" src="https://assets-cdn.github.com/images/icons/emoji/unicode/1f61b.png" height="20" width="20">)</p>

<h2 id="sorted-l1-penalty-in-2d">Sorted L1 penalty in 2D</h2>

<p>The Sorted $\ell\subscript{1}$ penalty is used in a number of regression-based methods, such as <em>SLOPE</em> (Bogdan et. al. 2015) and <em>OSCAR</em> (Bondell and Reich 2008). It has the form</p>

<script type="math/tex; mode=display">g\subscript{\boldsymbol{\lambda}}(\boldsymbol{\beta}) = \sum\subscript{i = 1}^m \lambda\subscript{i} \lvert \beta \rvert\subscript{(i)},</script>

<p>where $\lvert \beta \rvert\subscript{(1)} \geq \lvert \beta \rvert\subscript{(2)} \geq \ldots \geq \lvert \beta \rvert\subscript{(m)}$ are the absolute values of the entries of $\boldsymbol{\beta}$ arranged in a decreasing order. In 2D this reduces to</p>

<script type="math/tex; mode=display">g\subscript{\boldsymbol{\lambda}}(\boldsymbol{\beta}) = \lambda\subscript{1} \max\{|\beta\subscript{1}|, |\beta\subscript{2}|\} + \lambda\subscript{2} \min\{|\beta\subscript{1}|, |\beta\subscript{2}|\}.</script>

<p><img src="/images/penalty_function_contours/sorted_L1_balls.gif" alt="Loading..." title="sorted L1 norm balls"></p>

<h2 id="difference-of-p-norms">Difference of p-norms</h2>

<p>It holds that</p>

<script type="math/tex; mode=display">\lVert \boldsymbol{\beta} \rVert\subscript{1} \geq \lVert \boldsymbol{\beta} \rVert\subscript{2},</script>

<p>or more generally, for all $p$-norms it holds that</p>

<script type="math/tex; mode=display">(\forall p \leq q) : \lVert \boldsymbol{\beta} \rVert\subscript{p} \geq \lVert \boldsymbol{\beta} \rVert\subscript{q}.</script>

<p>Thus, it is meaningful to define a penalty function of the form</p>

<script type="math/tex; mode=display">g\subscript{\alpha}(\boldsymbol{\beta}) = \lVert \boldsymbol{\beta} \rVert\subscript{1} - \alpha \lVert \boldsymbol{\beta} \rVert\subscript{2},</script>

<p>for $\alpha\in[0,1]$, which results in the following.</p>

<p><img src="/images/penalty_function_contours/l1-l2_balls.gif" alt="Loading..." title="l1 norm minus l2 norm balls"></p>

<p>We visualize the same for varying $p \geq 1$ fixing $\alpha = 0.6$, i.e., we define</p>

<script type="math/tex; mode=display">g\subscript{\alpha}(\boldsymbol{\beta}) = \lVert \boldsymbol{\beta} \rVert\subscript{1} - 0.6 \lVert \boldsymbol{\beta} \rVert\subscript{p},</script>

<p>and we obtain the following GIF.</p>

<p><img src="/images/penalty_function_contours/l1-lp_balls.gif" alt="Loading..." title="l1 norm minus lp norm balls"></p>

<h2 id="hyperbolic-tangent-penalty-in-2d">Hyperbolic tangent penalty in 2D</h2>

<p>The hyperbolic tangent penalty, which is for example used in the method of variable selection via subtle uprooting (Su, 2015), has the form</p>

<script type="math/tex; mode=display">g\subscript{a}(\boldsymbol{\beta}) = \sum\subscript{i = 1}^p \tanh(a \beta\subscript{i}^2), \quad a>0.</script>

<p>Contrary to all of the previously shown penalty functions, for any fixed $a$ the hyperbolic tangent penalty has round contours (for small values of $g\subscript{a}$) as well as contours with sharp corners (for larger values of $g\subscript{a}$).</p>

<p><img src="/images/penalty_function_contours/hyperbolic_tangent_penalty.gif" alt="Loading..." title="Contours of the hyperbolic tangent penalty"></p>

<h1 id="code">Code</h1>

<p>The R code uses the libraries <code class="highlighter-rouge">dplyr</code> for data manipulation, <code class="highlighter-rouge">ggplot2</code> for generation of figures, and <code class="highlighter-rouge">magick</code> to combine the individual images into a GIF.</p>

<p>Here are the R scripts that can be used to reproduce the above GIFs:</p>

<ol>
  <li><a href="https://github.com/agisga/2D_norm_balls/blob/master/R/p-norm.R">p-norms in 2D</a></li>
  <li><a href="https://github.com/agisga/2D_norm_balls/blob/master/R/elastic_net.R">Elastic net penalty in 2D</a></li>
  <li><a href="https://github.com/agisga/2D_norm_balls/blob/master/R/fused.R">Fused penalty in 2D</a></li>
  <li><a href="https://github.com/agisga/2D_norm_balls/blob/master/R/sorted_L1.R">Sorted L1 penalty in 2D</a></li>
  <li><a href="https://github.com/agisga/2D_norm_balls/blob/master/R/l1-l2.R">Difference of $p$-norms: $\ell\subscript{1} - \ell\subscript{2}$ in 2D</a></li>
  <li><a href="https://github.com/agisga/2D_norm_balls/blob/master/R/l1-lp.R">Difference of $p$-norms: $\ell\subscript{1} - \ell\subscript{p}$ in 2D</a></li>
  <li><a href="https://github.com/agisga/2D_norm_balls/blob/master/R/hyperbolic_tangent_penalty.R">Hyperbolic tangent penalty</a></li>
</ol>

<p>Should I come across other interesting penalty functions that make sense in 2D, then I will add corresponding further visualizations to the same Github repository.</p>

<font size="3">
<a rel="license" href="http://creativecommons.org/licenses/by/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by/4.0/80x15.png"></a><br>This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>.
</font>

  </div>

  <div class="date">
    Written on March 18, 2017
  </div>

  <div class="date">
    Tags:
    
    <a href="/tag/r">#r</a>
    
    <a href="/tag/math">#math</a>
    
  </div>

  
<div class="comments">
	<div id="disqus_thread"></div>
	<script type="text/javascript">

	    var disqus_shortname = 'agisga';

	    (function() {
	        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
	        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
	        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
	    })();

	</script>
	<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a>
</noscript>
</div>

</article>

    </div>

    <div class="wrapper-footer">
      <div class="container">
        <footer class="footer">
          
<a href="mailto:alexej.go@gmail.com"><i class="svg-icon email"></i></a>
<a href="https://www.facebook.com/alexej.yexela"><i class="svg-icon facebook"></i></a>

<a href="https://github.com/agisga"><i class="svg-icon github"></i></a>

<a href="https://www.linkedin.com/in/alexejgossmann"><i class="svg-icon linkedin"></i></a>

<a href="/feed.xml"><i class="svg-icon rss"></i></a>




        </footer>
      </div>
    </div>

    
	<!-- Google Analytics -->
	<script>
		(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
		(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
		m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
		})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

		ga('create', 'UA-94080131-1', 'auto');
		ga('send', 'pageview', {
		  'page': '/contours_of_statistical_penalty_functions_as_GIFs/',
		  'title': 'Contours of statistical penalty functions as GIF images'
		});
	</script>
	<!-- End Google Analytics -->


  </body>
</html>
