<!DOCTYPE html>
<html>
  <head>
    <title>My first R package on CRAN – Alexej Gossmann</title>

        <meta charset="utf-8" />
    <meta content='text/html; charset=utf-8' http-equiv='Content-Type'>
    <meta http-equiv='X-UA-Compatible' content='IE=edge'>
    <meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1.0'>

    
    <meta name="description" content="A couple of weeks ago I have released my first R package on CRAN. For me it turned out to be a far less painful process than many people on the internet portray it to be (even though the package uses quite a lot of C++ code via Rcpp and RcppEigen, and even though R CMD check returns two NOTEs). Some of the most helpful resources for publishing the package were:

" />
    <meta property="og:description" content="A couple of weeks ago I have released my first R package on CRAN. For me it turned out to be a far less painful process than many people on the internet portray it to be (even though the package uses quite a lot of C++ code via Rcpp and RcppEigen, and even though R CMD check returns two NOTEs). Some of the most helpful resources for publishing the package were:

" />
    
    <meta name="author" content="Alexej Gossmann" />

    
    <meta property="og:title" content="My first R package on CRAN" />
    <meta property="twitter:title" content="My first R package on CRAN" />
    

    <!--[if lt IE 9]>
      <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <link rel="stylesheet" type="text/css" href="/style.css" />
    <link rel="alternate" type="application/rss+xml" title="Alexej Gossmann - PhD student with (severely sleep deprived) focus on statistics, machine learning, and programming" href="/feed.xml" />

    <!-- Created with Jekyll Now - http://github.com/barryclark/jekyll-now -->

    <!-- MathJax interation-->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({tex2jax: {inlineMath: [["$","$"]]}});
      MathJax.Hub.Config({TeX: {Macros:{subscript:['_{#1}',1],superscript:['^{#1}',1]}}});
    </script>
    <!-- Turn on equation numbering -->
    <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      TeX: { equationNumbers: { autoNumber: "AMS" } }
    });
    </script>
    <script type="text/javascript" async
      src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS_HTML-full">
    </script>
 </head>

  <body>
    <div class="wrapper-masthead">
      <header class="masthead clearfix">
        <a href="/" class="site-avatar"><img src="/images/avatar.png" /></a>

        <div class="site-info">
          <h1 class="site-name"><a href="/">Alexej Gossmann</a></h1>
          <p class="site-description">PhD student with (severely sleep deprived) focus on statistics, machine learning, and programming</p>
        </div>

        <nav>
          <a href="/">/blog/</a>
          <a href="/publications">/publications/</a>
          <a href="/code">/code/</a>
          <a href="/about">/about/</a>
        </nav>
      </header>
    </div>

    <div id="main" role="main" class="container">
      <article class="post">
  <h1>My first R package on CRAN</h1>

  <div class="entry">
    <p>A couple of weeks ago I have released my first R package on CRAN. For me it turned out to be a far less painful process than many people on the internet portray it to be (even though the package uses quite a lot of C++ code via Rcpp and RcppEigen, and even though R CMD check returns two NOTEs). Some of the most helpful resources for publishing the package were:</p>

<ul>
  <li>Of course, the chapter <a href="http://r-pkgs.had.co.nz/release.html">“Releasing a package” from Hadley Wickham’s book</a></li>
  <li>Julia Silge’s post <a href="http://juliasilge.com/blog/How-I-Stopped/">“How I Learned to Stop Worrying and Love R CMD Check”</a></li>
  <li>Karl Broman’s <a href="http://kbroman.org/pkg_primer/pages/cran.html">post on getting an R package to CRAN</a></li>
</ul>

<h3 id="grpslope">grpSLOPE</h3>

<p>My package is called <code class="highlighter-rouge">grpSLOPE</code> (<a href="https://github.com/agisga/grpSLOPE">github</a>, <a href="https://cran.r-project.org/web/packages/grpSLOPE/index.html">CRAN</a>), and I will very briefly introduce some of it’s functionality. The purpose of the Group SLOPE method is to fit a sparse linear regression model, while controlling the <em>group false discovery rate</em>. I illustrate what it means with a very simple example below (for some more detail see the <a href="https://cran.r-project.org/web/packages/grpSLOPE/vignettes/basic-usage.html">vignette</a>).</p>

<p>We generate a random model with a design matrix $X \in \mathbb{R}^{1000 \times 2000}$, whose entries are sampled from the standard normal distribution, and a coefficient vector $\beta$, whose entries are mostly zeros.</p>

<div class="language-R highlighter-rouge"><pre class="highlight"><code><span class="n">set.seed</span><span class="p">(</span><span class="m">1</span><span class="p">)</span><span class="w">

</span><span class="n">X</span><span class="w">    </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">matrix</span><span class="p">(</span><span class="n">rnorm</span><span class="p">(</span><span class="m">1000</span><span class="o">*</span><span class="m">2000</span><span class="p">),</span><span class="w"> </span><span class="m">1000</span><span class="p">,</span><span class="w"> </span><span class="m">2000</span><span class="p">)</span><span class="w">
</span><span class="n">beta</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">rep</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">2000</span><span class="p">)</span><span class="w">
</span><span class="n">beta</span><span class="p">[</span><span class="m">1</span><span class="o">:</span><span class="m">20</span><span class="p">]</span><span class="w">      </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">runif</span><span class="p">(</span><span class="m">20</span><span class="p">)</span><span class="w">
</span><span class="n">beta</span><span class="p">[</span><span class="m">1901</span><span class="o">:</span><span class="m">1980</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">runif</span><span class="p">(</span><span class="m">80</span><span class="p">)</span><span class="w">
</span><span class="n">y</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">X</span><span class="w"> </span><span class="o">%*%</span><span class="w"> </span><span class="n">beta</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">rnorm</span><span class="p">(</span><span class="m">1000</span><span class="p">)</span><span class="w">
</span></code></pre>
</div>

<p>We assume that the predictors (i.e., the columns of $X$) are divided into 200 blocks, each of size 10, and we want to determine which groups of predictors have an effect on the response variable $y$. That is, given the noisy observations of $y$, we want to find out, which blocks of the vector $\beta$ contain non-zero entries. As you can see above, $\beta$ has 10 non-zero blocks. Additionally, we want to make sure that we don’t make too many false discoveries in the process (i.e., we want the method to keep the expected proportion of falsely selected groups below, say, 10%). That’s exactly what the Group SLOPE method is for!</p>

<div class="language-R highlighter-rouge"><pre class="highlight"><code><span class="c1">#install.packages("grpSLOPE") # Install the package now easily from CRAN!
</span><span class="n">library</span><span class="p">(</span><span class="n">grpSLOPE</span><span class="p">)</span><span class="w">

</span><span class="n">group</span><span class="w">  </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">rep</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">200</span><span class="p">,</span><span class="w"> </span><span class="n">each</span><span class="o">=</span><span class="m">10</span><span class="p">)</span><span class="w">
</span><span class="n">grpSLOPE.result</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">grpSLOPE</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="n">X</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">group</span><span class="o">=</span><span class="n">group</span><span class="p">,</span><span class="w"> </span><span class="n">fdr</span><span class="o">=</span><span class="m">0.1</span><span class="p">)</span><span class="w">
</span></code></pre>
</div>

<p>We observe that the method has indeed selected the correct groups of predictors:</p>

<div class="language-R highlighter-rouge"><pre class="highlight"><code><span class="n">grpSLOPE.result</span><span class="o">$</span><span class="n">selected</span><span class="w">
</span><span class="c1">#  [1] "1"   "2"   "191" "192" "193" "194" "195" "196" "197" "198"
</span></code></pre>
</div>

<p>And the false discovery proportion is indeed below the target of 10% in this case, while the power is at 100%:</p>

<div class="language-R highlighter-rouge"><pre class="highlight"><code><span class="n">truly.significant.groups</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">unique</span><span class="p">(</span><span class="n">group</span><span class="p">[</span><span class="n">which</span><span class="p">(</span><span class="n">beta</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="m">0</span><span class="p">)])</span><span class="w">
</span><span class="n">truly.significant.groups</span><span class="w">
</span><span class="c1">#  [1]   1   2 191 192 193 194 195 196 197 198
</span><span class="w">
</span><span class="n">false.discoveries</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">setdiff</span><span class="p">(</span><span class="n">grpSLOPE.result</span><span class="o">$</span><span class="n">selected</span><span class="p">,</span><span class="w"> </span><span class="n">truly.significant.groups</span><span class="p">)</span><span class="w">
</span><span class="n">fdp</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">length</span><span class="p">(</span><span class="n">false.discoveries</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nf">length</span><span class="p">(</span><span class="n">grpSLOPE.result</span><span class="o">$</span><span class="n">selected</span><span class="p">)</span><span class="w">
</span><span class="n">fdp</span><span class="w">
</span><span class="c1">#  [1] 0
</span><span class="w">
</span><span class="n">true.discoveries</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">intersect</span><span class="p">(</span><span class="n">grpSLOPE.result</span><span class="o">$</span><span class="n">selected</span><span class="p">,</span><span class="w"> </span><span class="n">truly.significant.groups</span><span class="p">)</span><span class="w">
</span><span class="n">power</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">length</span><span class="p">(</span><span class="n">true.discoveries</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nf">length</span><span class="p">(</span><span class="n">grpSLOPE.result</span><span class="o">$</span><span class="n">selected</span><span class="p">)</span><span class="w">
</span><span class="n">power</span><span class="w">
</span><span class="c1">#  [1] 1
</span></code></pre>
</div>

<p>Of course, the method does not perform this good under all circumstances — the interested reader can learn more from the papers referred to in the <a href="https://github.com/agisga/grpSLOPE/blob/master/README.md">grpSLOPE README on github</a> (unfortunately, the “real” journal publication is still under preparation, and another related journal publication is currently under review, so, not publicly available yet either).</p>

  </div>

  <div class="date">
    Written on May 12, 2016
  </div>

  <div class="date">
    Tags:
    
    <a href="/tag/r">#r</a>
    
    <a href="/tag/grpSLOPE">#grpSLOPE</a>
    
    <a href="/tag/regression">#regression</a>
    
    <a href="/tag/FDR">#FDR</a>
    
  </div>

  
<div class="comments">
	<div id="disqus_thread"></div>
	<script type="text/javascript">

	    var disqus_shortname = 'agisga';

	    (function() {
	        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
	        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
	        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
	    })();

	</script>
	<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>

</article>

    </div>

    <div class="wrapper-footer">
      <div class="container">
        <footer class="footer">
          
<a href="mailto:alexej.go@gmail.com"><i class="svg-icon email"></i></a>
<a href="https://www.facebook.com/alexej.yexela"><i class="svg-icon facebook"></i></a>

<a href="https://github.com/agisga"><i class="svg-icon github"></i></a>

<a href="https://www.linkedin.com/in/alexejgossmann"><i class="svg-icon linkedin"></i></a>

<a href="/feed.xml"><i class="svg-icon rss"></i></a>




        </footer>
      </div>
    </div>

    
	<!-- Google Analytics -->
	<script>
		(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
		(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
		m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
		})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

		ga('create', 'UA-94080131-1', 'auto');
		ga('send', 'pageview', {
		  'page': '/grpSLOPE_on_CRAN/',
		  'title': 'My first R package on CRAN'
		});
	</script>
	<!-- End Google Analytics -->


  </body>
</html>
